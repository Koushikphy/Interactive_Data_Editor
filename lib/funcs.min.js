const fs=require("fs"),path=require("path"),url=require("url");var editorWindow,compFName,oldX,oldCord,indd,copyVar,undoStack=[],redoStack=[],viewer=[,,],show=!1,saved=!0,firstSave=!0,issame=!1;function showStatus(e){$("#status").html(e),$("#status").slideToggle().delay(3e3).slideToggle()}function updateData(){if(col.x=xCol.selectedIndex,col.y=yCol.selectedIndex,col.z=zCol.selectedIndex,th_in=0,ddd?($slider.slider({max:data.length-1,value:0}),$ch.text(xName+"="+data[0][col.x][0])):(col.z=col.y,col.y=col.x,col.x=0),updatePlot(1),startDragBehavior(),updateOnServer(),!swapped)if(ddd)localStorage.setItem("cols3d",JSON.stringify(col));else{var e={x:col.y,y:col.z,z:0,s:0};localStorage.setItem("cols2d",JSON.stringify(e))}var t=[];for(let e of data)t.push(e[col.x][0].toString().length);$ch.width(Math.floor(Math.max(...t)/2+2)*em2px)}function fileLoader(){const e=dialog.showOpenDialog({defaultPath:recentLocation,properties:["openFile"]});void 0!==e&&fileReader(e[0])}function fileReader(e){if(!saved)var t=dialog.showMessageBox({type:"warning",title:"Unsaved data found!!!",message:"There are some modified data, that you haven't saved yet.\n Are you sure to open a new file without saving?",buttons:["Yes","No"]});if(!t){swapped=0,refdat=0,xName="X",issame=!1,firstSave=!0,swapper=!1,$("#sCol, #sColInp").hide(),$("#particle").remove(),window.pJSDom instanceof Array&&window.pJSDom[0].pJS.fn.vendors.destroypJS(),$("#full").show(),2==figurecontainer.data.length&&Plotly.deleteTraces(figurecontainer,1),Plotly.relayout(figurecontainer,{selectdirection:"any"}),xCol=document.getElementById("xCol"),yCol=document.getElementById("yCol"),menu.getMenuItemById("pax").visible=!0,menu.getMenuItemById("pay").visible=!1,menu.getMenuItemById("compf").visible=!1,menu.getMenuItemById("swapen").visible=!0,menu.getMenuItemById("swapex").visible=!1;for(let e of["pax","wire","surf"])menu.getMenuItemById(e).enabled=!1;var a=path.dirname(e),o=path.basename(e,path.extname(e)),n=path.extname(e);save_name=path.join(a,o+"_new"+n),recentLocation=a,localStorage.setItem("recent",JSON.stringify(recentLocation)),data=parseData(data=fs.readFileSync(e,"utf8")),ddd=1!=data.length,document.title="Interactive Data Editor - "+replaceWithHome(e);var r,l=["save","saveas","spr","openc","pamh","swapen","edat","fill","filter"];if(ddd)$(".3D").show(),null!==(r=JSON.parse(localStorage.getItem("cols3d")))&&(col=r),l.push("pax","wire","surf");else serve=0,$(".3D").hide(),null!==(r=JSON.parse(localStorage.getItem("cols2d")))&&(col=r);for(var i="",s=1;s<=data[0].length;s++)i+="<option>"+s+"</option>";for(let e of $("#xCol, #yCol, #zCol, #sCol"))e.innerHTML=i;for(let e of l)menu.getMenuItemById(e).enabled=!0;xCol.selectedIndex=col.x,yCol.selectedIndex=col.y,zCol.selectedIndex=col.z,sCol.selectedIndex=col.s,updateData(),recentFiles=recentFiles.filter(t=>t!=e),recentFiles.push(e),recentFiles.length>10&&recentFiles.splice(0,1),recentMenu(),$ch.text(xName+"="+data[th_in][col.x][0]),$("#drag").html((e,t)=>t.replace("Y","X")),resizePlot(),showStatus("Data file loaded ...")}}function compfileLoader(){refdat=1;var e=dialog.showOpenDialog({defaultPath:recentLocation,properties:["openFile"]});void 0!==e&&(e=e[0],compdata=parseData(compdata=fs.readFileSync(e,"utf8")),swapped&&(compdata=expRotate(compdata)),showStatus((compFName=replaceWithHome(e))+" loaded for comparison."),updatePlot(1),menu.getMenuItemById("compf").visible=!0)}function transpose(e){return e[0].map((t,a)=>e.map(e=>e[a]))}function parseData(e){var t=[],a=[];e=e.trim().split(/\t\t\t|\n\n/);for(let n of e){a=n.trim().split("\n");for(var o=0;o<a.length;o++)a[o]=a[o].trim().split(/[\s\t]+/),a[o]=a[o].map(e=>parseFloat(e));t.push(transpose(a))}return t}function expRotate(e){if(e=e.map(e=>transpose(e)),!issame){issame=!0;var t=e[0].length;for(let a of e)if(a.length!=t){issame=!1;break}}if(issame)return e=(e=transpose(e)).map(e=>transpose(e));e=[].concat(...e).filter(e=>void 0!==e);var a=new Set;for(let t of e)a.add(t[col.x]);a=[...a].sort((e,t)=>e-t);var o=[];for(let t of a){var n=[];for(let a of e)t==a[col.x]&&n.push(a);n=n.sort((e,t)=>e[col.y]-t[col.y]),o.push(transpose(n))}return o}function rotateData(){data.length&&(data=expRotate(data),compdata.length&&(compdata=expRotate(compdata)))}function saveAs(){var e=dialog.showSaveDialog({title:"Save As:",defaultPath:save_name});void 0!==e&&(save_name=e,saveData(),firstSave=!1)}function saveData(){var e=data.map(e=>transpose(e));swapped&&(e=transpose(e));var t="";try{for(let a of e){for(let e of a)t+=e.map(e=>parseFloat(e).toFixed(8)).join("\t")+"\n";t+="\n"}fs.writeFileSync(save_name,t),showStatus("Data Saved in file "+replaceWithHome(save_name)),saved=!0}catch(e){return showStatus("Something went wrong! Couldn't save the data..."),!1}}function editor(){(editorWindow=new BrowserWindow({minWidth:1200,show:!1,webPreferences:{nodeIntegration:!0}})).maximize(),editorWindow.loadURL(url.format({pathname:path.join(__dirname,"handtable.html"),protocol:"file:",slashes:!0})),editorWindow.setMenuBarVisibility(!1),editorWindow.show(),app.isPackaged||editorWindow.webContents.openDevTools(),editorWindow.webContents.once("dom-ready",function(){editorWindow.webContents.send("slider",[xName,col.x,data])})}function openViewer(e){serve=1;var t="3D_Viewer_Lines.html";e&&(t="3D_Viewer_Surface.html"),viewerWindow=new BrowserWindow({show:!1,minWidth:1200,webPreferences:{nodeIntegration:!0}}),viewerWindow.maximize(),setTimeout(function(){viewerWindow.loadURL(url.format({pathname:path.join(__dirname,t),protocol:"file:",slashes:!0}))},50),viewerWindow.on("closed",function(){delete viewer[t]}),viewerWindow.show(),viewerWindow.setMenuBarVisibility(!1),viewer[t]=viewerWindow,app.isPackaged||viewerWindow.webContents.openDevTools(),viewerWindow.webContents.once("dom-ready",function(){updateOnServer()})}function incRefData(){menu.getMenuItemById("compf").checked?(refdat=1,updatePlot(1),showStatus(compFName+" shown for comparison.")):(refdat=0,Plotly.deleteTraces(figurecontainer,1))}function isswap(){swapped=!swapped;var[e,t]=["Y","X"];swapped&&([e,t]=[t,e]),xName=t,[xCol,yCol]=[yCol,xCol],[col.x,col.y]=[col.y,col.x],rotateData(),updateData(),th_in=0,$slider.slider("value",0),$ch.text(xName+"="+data[th_in][col.x][0]),$("#drag").html((a,o)=>o.replace(e,t))}function sliderChanged(){$("#custom-handle").blur(),$slider.slider("value",th_in),$ch.text(xName+"="+data[th_in][col.x][0]),updatePlot(1),startDragBehavior()}function colsChanged(e){col.s=e,updatePlot()}function colChanged(e){$("select").blur(),col.z=e,updatePlot(1),updateOnServer(),startDragBehavior(),swapped||localStorage.setItem("cols3d",JSON.stringify(col))}function resizePlot(){var e=window.innerHeight-document.getElementById("header").offsetTop-document.getElementById("figurecontainer").offsetTop;$("#figurecontainer").height(e-2),Plotly.relayout(figurecontainer,{autosize:!0})}function sSwapper(){[col.s,col.z]=[col.z,col.s],sCol.selectedIndex=col.s,zCol.selectedIndex=col.z,updatePlot(),updateOnServer()}function initSwapper(){$("#sCol, #sColInp").show(),refdat=0,swapper=!0,2==figurecontainer.data.length&&Plotly.deleteTraces(figurecontainer,1),Plotly.addTraces(figurecontainer,iniPointsC),col.s=sCol.selectedIndex,Plotly.relayout(figurecontainer,{selectdirection:"h"}),updatePlot(),menu.getMenuItemById("swapen").visible=!1,menu.getMenuItemById("swapex").visible=!0}function delSwapper(){$("#sCol, #sColInp").hide(),swapper=!1,2==figurecontainer.data.length&&Plotly.deleteTraces(figurecontainer,1),Plotly.relayout(figurecontainer,{selectdirection:"any"}),updatePlot(),menu.getMenuItemById("swapen").visible=!0,menu.getMenuItemById("swapex").visible=!1}function selectEvent(e){if(index=[],del_dat=[],void 0==e)Plotly.restyle(figurecontainer,{selectedpoints:[null]});else{for(let t of e.points)ind=dpsx.findIndex(e=>e==t.x),dpsy[ind]==t.y&&index.push(ind);index=[...new Set(index)]}}function updateFigure(){var e=[],t=[];if(lockXc){for(let t of points)e.push(t.handle.y);Plotly.restyle(figurecontainer,{y:[e]},0),dpsy=data[th_in][col.z]=e}else{for(let a of points)t.push(a.handle.x),e.push(a.handle.y);Plotly.restyle(figurecontainer,{x:[t],y:[e]},0),dpsy=data[th_in][col.z]=e,dpsx=data[th_in][col.y]=t}}function clamp(e,t,a){return Math.max(t,Math.min(e,a))}function startDragBehavior(){var e=Plotly.d3,t=e.behavior.drag();t.origin(function(){saveOldData();var t=e.select(this).attr("transform"),a=t.substring(10,t.length-1).split(/,| /);return index.length&&(oldCord=dpsy,indd=(oldX=dpsx).indexOf(this.handle.x)),{x:a[0],y:a[1]}}),t.on("drag",function(){var t=e.event.x,a=e.event.y;e.select(this).attr("transform","translate("+[t,a]+")");var o=this.handle,n=figurecontainer._fullLayout.yaxis;if(o.y=clamp(n.p2l(a),n.range[0],n.range[1]),index.length){var r=o.y-oldCord[indd];for(let e of index)points[e].handle.y=r+oldCord[e]}if(!lockXc){var l=figurecontainer._fullLayout.xaxis;if(o.x=clamp(l.p2l(t),l.range[0],l.range[1]),index.length){r=o.x-oldX[indd];for(let e of index)points[e].handle.x=r+oldX[e]}}updateFigure()}),t.on("dragend",function(){updateFigure(),updateOnServer(),e.select(".scatterlayer .trace:first-of-type .points path:first-of-type").call(t)}),e.selectAll(".scatterlayer .trace:first-of-type .points path").call(t)}function keyBoardDrag(e){if(index.length){ma&&(saveOldData(),ma=0);var t=figurecontainer._fullLayout.yaxis,a=t.p2l(1)-t.p2l(0);e&&(a=-a);for(let e of index)points[e].handle.y+=a;updateFigure()}}function saveOldData(){data.length&&(redoStack=[],olddata=JSON.stringify([th_in,col,data[th_in]]),10==undoStack.length&&undoStack.splice(0,1),undoStack.push(olddata),saved=!1)}function reDo(){redoStack.length&&(olddata=redoStack.pop(),undoStack.push(JSON.stringify([th_in,col,data[th_in]])),doIt())}function unDo(){ma||(ma=1),undoStack.length&&(olddata=undoStack.pop(),redoStack.push(JSON.stringify([th_in,col,data[th_in]])),doIt())}function doIt(){var e;[th_in,col,e]=JSON.parse(olddata),zCol.selectedIndex=col.z,data[th_in]=e,updatePlot(1),startDragBehavior(),updateOnServer(),saved=!1}function updateOnServer(){if(serve){var e=[],t=[],a=[];for(let o of data)e.push(o[col.x]),t.push(o[col.y]),a.push(o[col.z]);var o=[e,t,a];for(let e in viewer)viewer[e].webContents.send("sdata",[o,swapped,Object.values(col)])}}function updatePlot(e=0){dpsy=data[th_in][col.z],dpsx=data[th_in][col.y],swapper?(dpsy2=data[th_in][col.s],Plotly.restyle(figurecontainer,{x:[dpsx,dpsx],y:[dpsy,dpsy2]})):e&&refdat&&compdata.length?(1==figurecontainer.data.length&&Plotly.addTraces(figurecontainer,iniPointsC),Plotly.restyle(figurecontainer,{x:[dpsx,compdata[th_in][col.y]],y:[dpsy,compdata[th_in][col.z]]})):Plotly.restyle(figurecontainer,{x:[dpsx],y:[dpsy]},0);for(var t=0;t<dpsx.length;t++)points[t].handle={x:dpsx[t],y:dpsy[t]}}function copyThis(){copyVar=JSON.stringify(data[th_in])}function pasteThis(){saveOldData();var e=JSON.parse(copyVar);for(let t=0;t<e.length;t++)t!=col.x&&(data[th_in][t]=e[t]);updatePlot(1),updateOnServer(),saved=!1,startDragBehavior()}function swapData(){if(index.length){saveOldData();for(let e of index)[data[th_in][col.z][e],data[th_in][col.s][e]]=[data[th_in][col.s][e],data[th_in][col.z][e]];updatePlot(),updateOnServer()}}function repeatMirror(){var e=parseFloat($("#einp").val()),t=parseFloat($("#etime").val()),a=$("#repSel")[0].selectedIndex,o=[],n=data[0].length;for(let e=0;e<n;e++)e!=col.y&&o.push(e);data=data.map(n=>{var r=n[col.y].indexOf(e)+1;if(!r)return alert("Endpoint must exist !!!"),n;var l=n[col.y].slice(0,r);(s=l.slice()).splice(0,1);for(let a=0;a<t-1;a++)for(let t=0;t<s.length;t++)l.push(s[t]+e*(1+a));for(let e of o){var i=n[e].slice(0,r),s=i.slice();for(let e=0;e<t-1;e++)ptmp=a?s.reverse().slice():s.slice(),ptmp.splice(0,1),i.push(...ptmp);n[e]=i}return n[col.y]=l,n}),$("#extend").slideUp(),updatePlot(),showStatus(`Data ${n=a?"mirrored":"repeated"} ${t} times...`),startDragBehavior(),updateOnServer(),saved=!1}function dataFiller(){var e=parseFloat($("#fstart").val()),t=parseFloat($("#fend").val()),a=parseFloat($("#fstep").val()),o=[],n=data[0].length;for(let e=0;e<n;e++)e!=col.y&&o.push(e);var r=[];for(let o=e;o<=t;o+=a)r.push(o);data=data.map(e=>{if(r.length==e[0].length)return e;var t=e[col.y].slice(),a=e[col.y].length-1;for(let i of o){newArr=[];var n=e[i].slice();function l(e){for(var a=1;t[a]<e;)a++;var o=(e-t[a-1])/(t[a]-t[a-1]),r=ks[a-1]*(t[a]-t[a-1])-(n[a]-n[a-1]),l=-ks[a]*(t[a]-t[a-1])+(n[a]-n[a-1]);return(1-o)*n[a-1]+o*n[a]+o*(1-o)*(r*(1-o)+l*o)}ks=getNaturalKs(t,n);for(let t of r)ind=e[col.y].indexOf(t),-1!=ind?newArr.push(e[i][ind]):t<=e[col.y][0]?newArr.push(e[i][0]):t>=e[col.y][a]?newArr.push(e[i][a]):newArr.push(l(t));e[i]=newArr}return e[col.y]=r,e}),$("#filler").slideUp(),updatePlot(),showStatus("Missing values are filled..."),startDragBehavior(),updateOnServer(),saved=!1}function filterData(){var e=$("#flSel")[0].selectedIndex,t=parseFloat($("#flc").val()),a=parseFloat($("#flf").val()),o=$("#flcl").val().split(",").map(e=>parseFloat(e)-1);0==e?data=data.map(e=>{for(let n of o)e[n]=e[n].map(e=>e<t?a:e);return e}):1==e?data=data.map(e=>{for(let n of o)e[n]=e[n].map(e=>e>t?a:e);return e}):2==e&&(data=data.map(e=>{for(let n of o)e[n]=e[n].map(e=>e==t?a:e);return e})),$("#filter").slideUp(),updatePlot(),showStatus("Data filtered..."),startDragBehavior(),updateOnServer(),saved=!1}function getNaturalKs(e,t){for(var a=new Array(e.length).fill(0),o=e.length-1,n=[],r=0;r<o+1;r++)n.push(new Array(o+2).fill(0));for(r=1;r<o;r++)n[r][r-1]=1/(e[r]-e[r-1]),n[r][r]=2*(1/(e[r]-e[r-1])+1/(e[r+1]-e[r])),n[r][r+1]=1/(e[r+1]-e[r]),n[r][o+1]=3*((t[r]-t[r-1])/((e[r]-e[r-1])*(e[r]-e[r-1]))+(t[r+1]-t[r])/((e[r+1]-e[r])*(e[r+1]-e[r])));return n[0][0]=2/(e[1]-e[0]),n[0][1]=1/(e[1]-e[0]),n[0][o+1]=3*(t[1]-t[0])/((e[1]-e[0])*(e[1]-e[0])),n[o][o-1]=1/(e[o]-e[o-1]),n[o][o]=2/(e[o]-e[o-1]),n[o][o+1]=3*(t[o]-t[o-1])/((e[o]-e[o-1])*(e[o]-e[o-1])),solve(n,a)}function solve(e,t){for(var a=e.length,o=0;o<a;o++){for(var n=0,r=Number.NEGATIVE_INFINITY,l=o;l<a;l++)e[l][o]>r&&(n=l,r=e[l][o]);var i=e[o];e[o]=e[n],e[n]=i;for(l=o+1;l<a;l++)for(var s=o+1;s<a+1;s++)e[l][s]=e[l][s]-e[o][s]*(e[l][o]/e[o][o]),e[l][o]=0}for(l=a-1;l>=0;l--){var d=e[l][a]/e[l][l];t[l]=d;for(s=l-1;s>=0;s--)e[s][a]-=e[s][l]*d,e[s][l]=0}return t}function deleteInterpolate(){if(index.length){var e=dpsx.slice(),t=dpsy.slice();0==index[0]&&index.splice(0,1),index[index.length-1]==dpsx.length-1&&index.splice(-1,1);for(var a=index.length-1;a>=0;a--)e.splice(index[a],1),t.splice(index[a],1);ks=getNaturalKs(e,t),saveOldData();for(let e of index)data[th_in][col.z][e]=o(data[th_in][col.y][e]);updatePlot(),updateOnServer(),index=[],Plotly.restyle(figurecontainer,{selectedpoints:[null]}),saved=!1}function o(a){for(var o=1;e[o]<a;)o++;var n=(a-e[o-1])/(e[o]-e[o-1]),r=ks[o-1]*(e[o]-e[o-1])-(t[o]-t[o-1]),l=-ks[o]*(e[o]-e[o-1])+(t[o]-t[o-1]);return(1-n)*t[o-1]+n*t[o]+n*(1-n)*(r*(1-n)+l*n)}}function autoSmooth(){if(ma&&(saveOldData(),ma=0),index.length){0==index[0]&&index.splice(0,1),index[index.length-1]==dpsx.length-1&&index.splice(-1,1);for(let e of index)dpsy[e]=(dpsy[e-1]+dpsy[e]+dpsy[e+1])/3;data[th_in][col.z]=dpsy,updatePlot(),saved=!1}}function changeSign(){if(index.length){saveOldData();for(let e of index)data[th_in][col.z][e]*=-1;updatePlot(),updateOnServer(),index=[],Plotly.restyle(figurecontainer,{selectedpoints:[null]}),saved=!1}}function hotDKeys(e){if("text"!=document.activeElement.type)switch(e.key){case"m":case"ArrowDown":case"ArrowUp":ma=1,updateOnServer()}}function hotKeys(e){if("text"!=document.activeElement.type)switch(e.key){case" ":Plotly.relayout(figurecontainer,{"xaxis.autorange":!0,"yaxis.autorange":!0});break;case",":if(0==th_in)break;th_in-=1,sliderChanged();break;case".":if(th_in==data.length-1)break;th_in+=1,sliderChanged();break;case"s":case"S":e.ctrlKey||Plotly.relayout(figurecontainer,{dragmode:"select"});break;case"z":case"Z":e.ctrlKey&!e.shiftKey?unDo():e.ctrlKey&e.shiftKey?reDo():Plotly.relayout(figurecontainer,{dragmode:"zoom"});break;case"p":case"P":swapData();break;case"d":case"D":deleteInterpolate();break;case"m":case"M":autoSmooth();break;case"c":case"C":e.ctrlKey?copyThis():changeSign();break;case"v":case"V":e.ctrlKey&&pasteThis();break;case"ArrowDown":keyBoardDrag(0);break;case"ArrowUp":keyBoardDrag(1)}}ipcRenderer.on("rf",function(e,t){fileReader(t)}),ipcRenderer.on("back",function(e,t){data=t.map(e=>transpose(e)),updatePlot(1),startDragBehavior(),updateOnServer()}),ipcRenderer.on("checkClose",function(e,t){if(!saved)var a=dialog.showMessageBox({type:"warning",title:"Unsaved data found!!!",message:"There are some modified data, that you haven't saved yet.\n Are you sure to quit without saving?",buttons:["Yes","No"]});a||ipcRenderer.send("checkClose","closeIt")}),ipcRenderer.on("menuTrigger",function(e,t){switch(show&&console.log(e,t),t){case"open":fileLoader();break;case"save":firstSave?saveAs():saveData();break;case"saveas":saveAs();break;case"wire":openViewer(0);break;case"surface":openViewer(1);break;case"spread":editor();break;case"openc":compfileLoader();break;case"compf":incRefData();break;case"pa":isswap();break;case"pamh":lockXc=menu.getMenuItemById("pamh").checked?1:0;break;case"fullscreen":resizePlot();break;case"swapen":initSwapper();break;case"swapex":delSwapper();break;case"edat":$("#extend").slideDown();break;case"fill":$("#filler").slideDown();break;case"filter":$("#filter").slideDown()}}),$(window).keydown(hotKeys),$(window).keyup(hotDKeys);var file,points,pointscontainer,data=[],compdata=[],olddata="",dpsx=[],dpsy=[],dpsy2=[],index=[],del_dat=[],th_in=0,refdat=1,ma=1,serve=0,lockXc=1,swapped=0,swapper=!1,ddd=!1,col={x:0,y:0,z:0,s:0},xName="X",$slider=$("#slider"),xCol=document.getElementById("xCol"),yCol=document.getElementById("yCol"),zCol=document.getElementById("zCol"),sCol=document.getElementById("sCol"),xVal=document.getElementById("x_val"),figurecontainer=document.getElementById("figurecontainer");$ch=$("#custom-handle");var layout={autosize:!0,plot_bgcolor:"#e8ebef",showlegend:!1,hovermode:"closest",margin:{t:25,r:0,b:19,l:10,pad:0},xaxis:{zeroline:!1,showline:!0},yaxis:{automargin:!0,zeroline:!1,showline:!0,tickformat:" ,.5g",hoverformat:" ,.6g"},font:{size:14}},iniPointsD={x:[1],y:[1],type:"scatter",mode:"markers+lines",marker:{symbol:"circle-dot",color:"#b00"},line:{width:2,color:"#1e77b4"},hoverinfo:"x+y"},iniPointsC={x:[1],y:[1],type:"scatter",mode:"markers+lines",marker:{symbol:"x",color:"#f17010"},line:{width:2,color:"#3c6d2b"},hoverinfo:"x+y"};const Plotly=require("plotly.js-gl3d-dist");Plotly.newPlot(figurecontainer,[iniPointsD],layout,{displaylogo:!1,modeBarButtonsToRemove:["sendDataToCloud"]}),pointscontainer=figurecontainer.querySelector(".scatterlayer .trace:first-of-type .points"),points=pointscontainer.getElementsByTagName("path"),figurecontainer.on("plotly_selected",selectEvent),resizePlot(),$(function(){$slider.slider({min:0,max:0,step:1,slide:function(e,t){th_in=t.value,sliderChanged()}})});var em2px=$ch.width()/3;