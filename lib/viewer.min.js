var figurecontainer=document.getElementById("figurecontainer"),data=[],cols=[0,1,2],ldata=[],lIniData=[],ranges=[],swapped=!1,newCol=[0,0,0],curCol=!1;const{ipcRenderer:ipcRenderer}=require("electron"),Plotly=require("plotly.js-gl3d-dist");function transpose(e){return e[0].map((a,n)=>e.map(e=>e[n]))}function getRange(e,a){var n,t;if(e=e.split(",").map(e=>parseFloat(e)),!isNaN(e[0])&!isNaN(e[1]))return e;var o=data[a].flat();return t=Math.max(...o),n=Math.min(...o),isNaN(e[0])&&(e[0]=n),isNaN(e[1])&&(e[1]=t),cmin=Math.max(e[0],n),cmax=Math.min(e[1],t),[e,[cmin,cmax]]}function setXYRange(e,a){if(ax=a?"yaxis":"xaxis",""==e){var n=`scene.${ax}.autorange`;Plotly.relayout(figurecontainer,{[n]:!0})}else{[e,_]=getRange(e,cols[a]);n=`scene.${ax}.range`;Plotly.relayout(figurecontainer,{[n]:e})}}function setZRange(e){""!=e?([e,[cmin,cmax]]=getRange(e,cols[2]),Plotly.relayout(figurecontainer,{"scene.zaxis.range":e}),Plotly.restyle(figurecontainer,{cmin:cmin,cmax:cmax})):Plotly.relayout(figurecontainer,{"scene.zaxis.autorange":!0})}function makeRotation(){var e=!0,a=data[0][0].length;for(let n of data[0])if(n.length!=a){e=!1;break}if(e)return xxx=transpose(data[0]),yyy=transpose(data[1]),void(zzz=transpose(data[2]));var n=[].concat(...data[0]).filter(e=>void 0!==e),t=[].concat(...data[1]).filter(e=>void 0!==e),o=[].concat(...data[2]).filter(e=>void 0!==e),r=[...new Set(t)].sort((e,a)=>e-a);xxx=[],yyy=[],zzz=[];for(let e of r){var i=[],l=[],s=[];for(let a=0;a<n.length;a++)t[a]==e&&(i.push(n[a]),l.push(t[a]),s.push(o[a]));xxx.push(i),yyy.push(l),zzz.push(s)}}function initData(e){for(var a=[],n=0;n<e;n++)a.push({type:"scatter3d",mode:"lines",x:[1,2],y:[1,2],z:[1,2],marker:{size:1.7,color:"#1f77b4"},line:{color:"#ff7f0e"},hoverinfo:"x+y+z",hoverlabel:{bgcolor:"#2ca02c"}});return a}ipcRenderer.on("sdata",function(e,a){[data,swapped,newCol]=a,updatePlot(),curCol||(curCol=newCol),newCol[0]!==curCol[0]?(curCol[0]=newCol[0],setXYRange($("#xInp").val(),0)):newCol[1]!==curCol[1]?(curCol[1]=newCol[1],setXYRange($("#yInp").val(),1)):newCol[2]!==curCol[2]&&(curCol[2]=newCol[2],setZRange($("#zInp").val()))});var sIniData=[{type:"surface",hoverinfo:"x+y+z",colorscale:"Portland",showscale:!1,hoverlabel:{bgcolor:"#2ca02c"},z:[[1]],x:[[1]],y:[[1]]}],layout={height:window.innerHeight+68,width:window.innerWidth-17,margin:{t:0,r:50,b:0,l:25,pad:0},showlegend:!1,scene:{aspectmode:"cube",zaxis:{autorange:!0,spikesides:!1},yaxis:{spikesides:!1},xaxis:{spikesides:!1}}};