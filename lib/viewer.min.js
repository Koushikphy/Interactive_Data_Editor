var figurecontainer=document.getElementById("figurecontainer"),data=[],cols=[0,1,2],ldata=[],lIniData=[],ranges=[],swapped=!1,newCol=[0,0,0],curCol=!1;const{ipcRenderer:ipcRenderer}=require("electron"),Plotly=require("plotly.js-gl3d-dist");function transpose(e){return e[0].map((a,n)=>e.map(e=>e[n]))}function mark_clicked(e){e.checked?Plotly.restyle(figurecontainer,{mode:"markers+lines"}):Plotly.restyle(figurecontainer,{mode:"lines"})}function getRange(e,a,n){var t,o;if(e=e.split(",").map(e=>parseFloat(e)),a)[t,o]=a;else{var r=data[n].flat();o=Math.max(...r),t=Math.min(...r)}return isNaN(e[0])&&(e[0]=t),isNaN(e[1])&&(e[1]=o),cmin=Math.max(e[0],t),cmax=Math.min(e[1],o),[e,[cmin,cmax]]}function setXRange(e,a=!1){""!=e?([e,_]=getRange(e,a,cols[0]),Plotly.relayout(figurecontainer,{"scene.xaxis.range":e})):Plotly.relayout(figurecontainer,{"scene.xaxis.autorange":!0})}function setYRange(e,a=!1){""!=e?([e,_]=getRange(e,a,cols[1]),Plotly.relayout(figurecontainer,{"scene.yaxis.range":e})):Plotly.relayout(figurecontainer,{"scene.yaxis.autorange":!0})}function setZRange(e,a=!1){""!=e?([e,[cmin,cmax]]=getRange(e,a,cols[2]),Plotly.relayout(figurecontainer,{"scene.zaxis.range":e}),Plotly.restyle(figurecontainer,{cmin:cmin,cmax:cmax})):Plotly.relayout(figurecontainer,{"scene.zaxis.autorange":!0})}function makeRotation(){var e=!0,a=data[0][0].length;for(let n of data[0])if(n.length!=a){e=!1;break}if(e)return xxx=transpose(data[0]),yyy=transpose(data[1]),void(zzz=transpose(data[2]));var n=[].concat(...data[0]).filter(e=>void 0!==e),t=[].concat(...data[1]).filter(e=>void 0!==e),o=[].concat(...data[2]).filter(e=>void 0!==e),r=[...new Set(t)].sort((e,a)=>e-a);xxx=[],yyy=[],zzz=[];for(let e of r){var l=[],i=[],c=[];for(let a=0;a<n.length;a++)t[a]==e&&(l.push(n[a]),i.push(t[a]),c.push(o[a]));xxx.push(l),yyy.push(i),zzz.push(c)}}function initData(e){for(var a=[],n=0;n<e;n++)a.push({type:"scatter3d",mode:"lines",x:[1,2],y:[1,2],z:[1,2],marker:{size:1.7,color:"#1f77b4"},line:{color:"#ff7f0e"},hoverinfo:"x+y+z",hoverlabel:{bgcolor:"#2ca02c"}});return a}ipcRenderer.on("sdata",function(e,a){[data,swapped,newCol]=a,updatePlot(),curCol||(curCol=newCol),newCol[0]!==curCol[0]?(curCol[0]=newCol[0],setXRange($("#xInp").val())):newCol[1]!==curCol[1]?(curCol[1]=newCol[1],setYRange($("#yInp").val())):newCol[2]!==curCol[2]&&(curCol[2]=newCol[2],setZRange($("#zInp").val()))});var sIniData=[{type:"surface",hoverinfo:"x+y+z",colorscale:"Portland",showscale:!1,hoverlabel:{bgcolor:"#2ca02c"},z:[[1]],x:[[1]],y:[[1]]}],layout={height:window.innerHeight+68,width:window.innerWidth-17,margin:{t:0,r:50,b:0,l:25,pad:0},showlegend:!1,scene:{aspectmode:"cube",zaxis:{autorange:!0,spikesides:!1},yaxis:{spikesides:!1},xaxis:{spikesides:!1}}};