<!DOCTYPE html>
<html>
<head>
    <title>Interactive Data Editor</title>
    <link href="../JsCSS/style.css" rel="stylesheet">
    <link rel="stylesheet" href="../JsCSS/jquery-ui.min.css">
<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>

</head>
<body>
<div class="basediv" id="particle">
<div class="parent">
<div class="container">
    <img src="../icons/charts.png" width="75" height="75">
    <div style="font-weight: bold;font-size: xx-large;">Interactive Data Editor</div>
    <div style="font-size: large;font-style: italic;margin-top: 3px; font-weight:500">A Software to interactively edit data in a graphical manner</div>
    <div style="font-size: larger;margin-top: 5px;font-style: italic;margin-bottom: 9px; font-weight:600">Developed by Koushik Naskar</div>
    <div style="font-size: large;margin-top: 7px">Version 2.1.0 </div>
    <div style="font-size: larger;margin-top: 50px;font-style: italic;margin-bottom: 9px;font-weight:530">Copyright &copy; Jan, 2019 Koushik Naskar</div>
    <a href="javascript:void(0)" onclick="shell.openExternal('https://www.facebook.com/koushik.naskar3');"><img src="../icons/facebook.png" width="30" height="30"></a>
    <a href="javascript:void(0)" onclick="shell.openExternal('https://github.com/Koushikphy');"><img src="../icons/github.png" width="30" height="30"></a>
    <a href="javascript:void(0)" onclick="shell.openExternal('https://mail.google.com/mail/?view=cm&fs=1&to=koushik.naskar9@gamil.com&su=[Interactive Data Editor]');"><img src="../icons/gmail.png" width="30" height="30"></a>

</div>
</div>
</div>

<div id="full" style="display: none;">
	
<div id="header">
        An interactive 2D and 3D data editor
</div>


<div class="borders" style="margin-top: 5px; width:100%" id="container">
        &nbsp;Data Column â‡’ &ensp;
        X :<select id="xCol" onchange="updateData();"></select>&ensp;
        Y :<select id="yCol" onchange="updateData();"></select>&ensp;
        <span class="3D">Z :<select id="zCol" onchange="colChanged(this.selectedIndex)"></select> &ensp;</span>
        <select id="sCol" onchange="colsChanged(this.selectedIndex)" style="display: none"></select>

<div id="drag" class='3D'>&nbsp;Drag the slider to change 'X' value:</div>
<div id="slider" class='3D' style="background: #eaeaea">
  <div id="custom-handle" class="ui-slider-handle" style="background: #4CAF50; color:#ffffff"></div>
</div>
</div>
<div class="borders" style="width: 100%;display: none;" id="extend">
    Extend from : <span style="font-family: sans-serif;"> 0</span> to <input type="text" id ="einp" style="width: 46px"> <br>
    Extend times: <input type="text" id = "etime" style="width: 76px;">    
    <input type="submit" value="OK" onclick="repeatMirror()" style="width: 5pc;height: 1.9pc">    
    <input type="submit" value="Cancel" onclick="$('#extend').slideUp();" style="width: 5pc;height: 1.9pc">
    <br> 
    Extend by:
    <select style="width: 5pc;margin-left: 18px;" id="repSel">
        <option>Repeat</option>
        <option>Mirror</option>
    </select><br>
</div>


<div class="borders" style="width: 100%;display: none;" id="filler">
    Start : <input type="text" id ="fstart" style="width: 5pc"> <br>
    End &nbsp;: <input type="text" id = "fend" style="width: 5pc;">    
    <input type="submit" value="OK" onclick="dataFiller()" style="width: 5pc;height: 1.9pc">    
    <input type="submit" value="Cancel" onclick="$('#filler').slideUp();" style="width: 5pc;height: 1.9pc"><br> 
    Step : <input type="text" id = "fstep" style="width: 5pc;">
</div>

<div id="figurecontainer"></div>


</div>
<div id="status">Load your data to get started...</div>
<script src="../particles.js"></script>

<script src="../JsCSS/plotly-latest.min.js"></script>
<script src="../JsCSS/jquery.min.js"></script>
<script src="../JsCSS/jquery-ui.min.js"></script>
<script src="../JsCSS/functions.js"></script>
<script src="../JsCSS/plotSetup.js"></script>
<script>





    particlesJS.load('particle', '../particles.json');

    req({
        'url':"https://api.github.com/repos/Koushikphy/Interactive-Data-Editor/tags",
        'headers':{'User-Agent' : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1521.3 Safari/537.36});'}}, 
        function (err, resp, body) {
            var new_ver =JSON.parse(body)[0].name
            console.log(new_ver)
            if(new_ver!="v1.3.0"){
                var txt = `A new version of the software ${new_ver} is available.\n Do you wnat to downlod it now?`
                var res = dialog.showMessageBox({type:"question",title:"Update available!!!", message:txt,buttons:['OK', "Cancel"]})
                if(!res){shell.openExternal("https://github.com/Koushikphy/Interactive-Data-Editor/releases")}
            }
    })

    Plotly.newPlot(figurecontainer, [iniPointsD], layout, {displaylogo: false, modeBarButtonsToRemove: ['sendDataToCloud']});
    pointscontainer = figurecontainer.querySelector(".scatterlayer .trace:first-of-type .points");
    points = pointscontainer.getElementsByTagName("path");
    figurecontainer.on("plotly_selected",selectEvent);
        

    var fl = JSON.parse(localStorage.getItem("files"));
    if (fl!==null){
        recentFiles = fl;
        recentMenu();
    }

    var fl = JSON.parse(localStorage.getItem("recent"));
    if (fl!==null){
        recentLocation = fl;
    }


    function op(link) {
        shell.openExternal(link);
    }

    for (let i of ['save', 'saveas', 'cs', 'ma', 'cg', 'un','wire','surf', "spr",'openc','pamh','pa','swapen',"edat", "fill"]){
        Menu.getApplicationMenu().getMenuItemById(i).enabled = false;
    }
    Menu.getApplicationMenu().getMenuItemById("compf").visible = false;







  $(function() {
    $slider.slider({min:0,max:0,step:1,
      slide: function( event, ui ) {
        th_in = ui.value;
        sliderChanged();
      }
    });
  });







        var em2px = $ch.width()/3


        function updateData() {
            col.x = xCol.selectedIndex;
            col.y = yCol.selectedIndex;
            col.z = zCol.selectedIndex;
            th_in= 0;
            if (ddd){ //3D
                $slider.slider({max:  data.length-1, value:0  })
                $ch.text(xName+'='+ data[0][col.x][0])

            } else {    //2D
                col.z = col.y;
                col.y = col.x;
                col.x =0
            };
            updatePlot(1);
            startDragBehavior();
            updateOnServer();
            if(!swapped){
            if(ddd){
            	localStorage.setItem("cols3d",JSON.stringify(col));
            } else {
            	var tmp={x:col.y,y:col.z,z:0,s:0}
            	localStorage.setItem("cols2d",JSON.stringify(tmp));
            }
        }
        var tmpl = []
        for (let i of data) {
            tmpl.push(i[col.x][0].toString().length);
        }
        $ch.width(Math.floor((Math.max(...tmpl)/2)+2)*em2px);

        };




        function thisJobs() {
            $("#particle").remove()
            $("#full").show()
            xCol            =document.getElementById("xCol");
            yCol            =document.getElementById("yCol");
            if(ddd){//3
                $(".3D").show()
                var fl = JSON.parse(localStorage.getItem("cols3d"));
			    if (fl!==null){
			        col = fl;
			    }

                var mn = ["pa",'wire','surf']
                for (let i of mn){
                    Menu.getApplicationMenu().getMenuItemById(i).enabled = true;
                }

            }else{             //2d
                serve = 0;
                $(".3D").hide()
                var fl = JSON.parse(localStorage.getItem("cols2d"));
			    if (fl!==null){
			        col = fl;
			    }
                var mn = ["pa",'wire','surf']
                for (let i of mn){
                    Menu.getApplicationMenu().getMenuItemById(i).enabled = false;
                }
            }

            var op = "";
            for (var i = 1; i <= data[0].length; i++) {
                op += '<option>' + i + '</option>';
            };
            var tmp = $("select:not(:last)");
            for (var i = 0; i < tmp.length; i++) {
                tmp[i].innerHTML = op;
            };
            resizePlot();
            xCol.selectedIndex=col.x;
            yCol.selectedIndex=col.y;
            zCol.selectedIndex=col.z;
            sCol.selectedIndex=col.s;
            updateData();
        };


</script>
</body>
</html>